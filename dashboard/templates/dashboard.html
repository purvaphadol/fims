{% extends 'main.html' %}
{% load static %}
{% block title %} Dashboard {% endblock %}
{% block content %}
<section class="dash-section">
    <div class="familyCard">
        <p class="totalHeading">Total Families</p>
        <div>
            <p class="numCount">{{ heads.count }}</p>
            <a href="{% url 'family_list' %}"><img src="{% static 'images/arrow_outward.png' %}" alt="family"></a>
        </div>
    </div>
    <div class="memberCard">
        <p class="totalHeading">Total Members</p>
        <div>
            <p class="numCount">{{ members.count }}</p>
            <a href="{% url 'family_list' %}"><img src="{% static 'images/arrow_outward.png' %}" alt="family"></a>
        </div>
    </div>
    <div class="stateCard">
        <p class="totalHeading"> Total States</p>
        <div>
            <p class="numCount">{{ states.count }}</p>
            <a href="{% url 'state_list' %}"><img src="{% static 'images/arrow_outward.png' %}" alt="family"></a>
        </div>
    </div>
    <div class="cityCard">
        <p class="totalHeading"> Total Cities</p>
        <div>
            <p class="numCount">{{ cities.count }}</p>
            <a href="{% url 'city_list' %}"><img src="{% static 'images/arrow_outward.png' %}" alt="family"></a>
        </div>
    </div>
    <canvas id="myChart" style="width:100%;max-width:700px"></canvas>
</section>


<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script>
    var data = JSON.parse('{{ json_data | safe }}');
    console.log(data)
    var xValues = data.map(item => item.state_name);
    var yValues = data.map(item => item.total);
    var barColors = ["#b91d47", "#00aba9","#2b5797", "#e8c3b9", "#1e7145"];

    new Chart("myChart", {
        type: "pie",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
        options: {
            title: {
                display: true,
                text: "Total Families Per State"
            }
        }
    });
</script>
{% endblock %}